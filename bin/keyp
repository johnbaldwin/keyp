#!/usr/bin/env ruby
# encoding: UTF-8

#
# NOTE: This is my first ruby gem and first executable ruby gem. I see a bunch of different
# implementations. A good number and a few well known use Thor, so seems like a good idea to
# figure out how to use Thor as well.
#
# I'm trying out some of the different impementations for Keyp, learning how they work, pros and cons
# Then I'll pick a single approach after exploring them

# TO run in the project dir:
# ruby -Ilib ./bin/keyp

# resolve bin path, ignoring symlinks
require 'pathname'
bin_file = Pathname.new(__FILE__).realpath

require 'gli'
require 'keyp'
include GLI::App

# keyp set key=value
# keyp get key
# keyp


program_desc 'A command line linterface for the Keyp key/value manager'

flag [:b,:bag], default_value: 'default'

pre do |global_options, command, options, args|
  # initialize our store
  $bag = Keyp.bag(global_options[:bag])
end

command :list do |c|
  c.action do
    $bag.data.each do |key,value|
      #printf("$s : $s\n", key,value)
      puts "#{key} = #{value}"
    end
  end
end

exit run(ARGV)
